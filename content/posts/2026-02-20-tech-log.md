---
title: "Gemini 3 이미지 생성 API 파헤치기 — Nano Banana Pro와 LLM 비용 계산"
date: 2026-02-20
categories: ["tech-log"]
tags: ["gemini", "image-generation", "llm", "api", "google-ai", "token", "cost"]
toc: true
math: false
---

## 개요

오늘은 `gemini-3-pro-image-preview` 모델을 이용해 이미지 생성 API를 구축하면서 생긴 궁금증들을 정리했다.
해상도에 따른 비용 구조, Thought Signatures의 작동 방식, 그리고 실제 프로덕션 활용 시 주의할 점들을 Gemini 3 공식 문서를 기반으로 살펴봤다.

## Gemini 3 모델 패밀리와 가격

Gemini 3는 현재 프리뷰 상태이지만 실제로 쓸 수 있는 수준이다. 모델별 스펙은 다음과 같다.

| 모델 ID | 컨텍스트 (In/Out) | 가격 (입력/출력) |
|---|---|---|
| `gemini-3.1-pro-preview` | 1M / 64k | $2 / $12 (200k 이하) |
| `gemini-3-pro-preview` | 1M / 64k | $2 / $12 (200k 이하) |
| `gemini-3-flash-preview` | 1M / 64k | $0.50 / $3 |
| `gemini-3-pro-image-preview` | 65k / 32k | $2 (텍스트 입력) / $0.134 (이미지 출력)** |

이미지 모델의 경우 **출력 이미지 1장당 $0.134**가 기준이지만, 해상도에 따라 달라진다. 1K가 기본이고 4K로 갈수록 비용이 증가한다. 정확한 해상도별 비용은 별도 pricing 페이지를 참조해야 한다.

## Nano Banana Pro — Gemini 3 이미지 생성의 핵심

Google이 공식적으로 "Nano Banana"라는 코드명을 쓰는 게 독특한데, 이 이름은 Gemini의 네이티브 이미지 생성 기능 전체를 가리킨다. 두 가지 모델이 있다:

- **Nano Banana**: `gemini-2.5-flash-image` — 속도·효율 중심, 대량 처리에 적합
- **Nano Banana Pro**: `gemini-3-pro-image-preview` — 프로 에셋 생산용, Thinking 기반 고품질

Gemini 3 Pro Image가 기존 Imagen과 다른 점은 **추론(Thinking) 과정이 이미지 생성에 통합**된다는 것이다. 복잡한 프롬프트를 받으면 모델이 내부적으로 "thought images"를 최대 2장 생성해 구도와 로직을 검증한 뒤 최종 이미지를 출력한다. 이 중간 이미지는 과금되지 않는다.

### 주요 신기능

**1. 최대 14개 레퍼런스 이미지**

`gemini-3-pro-image-preview`는 레퍼런스 이미지를 최대 14개까지 받을 수 있다:
- 오브젝트 고해상도 이미지: 최대 6개
- 인물 캐릭터 일관성 유지: 최대 5개

이를 활용하면 특정 제품이나 캐릭터의 일관성을 유지하면서 다양한 씬을 생성할 수 있다.

**2. 해상도 제어 — 1K / 2K / 4K**

기본은 1K 출력이며, `generation_config`에서 `image_size`를 지정해 올릴 수 있다. 주의할 점은 **반드시 대문자 K**를 써야 한다는 것 — `1k`로 쓰면 에러가 난다.

```python
generation_config = {
    "image_size": "2K"  # "1K", "2K", "4K" 가능. 소문자 불가!
}
```

**3. Google Search Grounding**

`google_search` 툴을 연결하면 실시간 정보 기반 이미지를 생성할 수 있다. 날씨 예보 차트, 주가 그래프, 최근 뉴스 기반 인포그래픽 등이 가능하다. 단, 이미지 기반 검색 결과는 생성 모델에 전달되지 않으며 응답에서도 제외된다.

## Thought Signatures — 멀티턴 편집의 핵심 메커니즘

이미지 생성 API를 처음 쓸 때 가장 헷갈리는 부분이 **Thought Signatures**다. 이게 뭔지 이해하면 멀티턴(대화형) 이미지 편집이 왜 그렇게 동작하는지 명확해진다.

Thought Signature는 모델의 내부 추론 과정을 암호화한 문자열이다. 모델이 이미지를 생성하면 응답에 `thought_signature` 필드가 포함되는데, **다음 요청을 보낼 때 이 값을 그대로 돌려줘야** 한다. 그래야 모델이 이전 이미지의 구도·로직을 기억하면서 편집할 수 있다.

```
이미지 생성 요청 → 응답에 thought_signature 포함
→ "배경을 석양으로 바꿔줘" 요청 시 thought_signature 같이 전송
→ 모델이 구도 컨텍스트를 유지하며 편집
```

이미지 생성/편집에서는 **strict validation**이 적용된다 — signature를 빼먹으면 400 에러가 발생한다. 공식 Python/Node/Java SDK를 쓰고 chat history를 그대로 넘기면 자동 처리되니, SDK 없이 raw REST를 쓸 때만 직접 관리해야 한다.

### Gemini 2.5에서 마이그레이션 시 주의사항

기존 Gemini 2.5 conversation trace를 그대로 쓰거나 커스텀 function call을 주입할 경우 유효한 signature가 없다. 이때는 dummy 값으로 우회할 수 있다:

```json
"thoughtSignature": "context_engineering_is_the_way to_go"
```

## Gemini 3의 새 API 파라미터들

**`thinking_level`** — 모델 추론 깊이 제어

| 레벨 | 설명 |
|---|---|
| `minimal` | Flash만 지원. thinking 최소화, 지연 최소 |
| `low` | 간단한 지시 따르기, 고처리량 앱에 적합 |
| `medium` | 균형잡힌 추론 |
| `high` | 기본값. 추론 최대화, 응답이 느릴 수 있음 |

`thinking_level`과 구형 `thinking_budget` 파라미터를 동시에 쓰면 400 에러가 발생한다.

**`media_resolution`** — 멀티모달 비전 처리 정밀도 제어

이미지 분석은 `media_resolution_high` (1120 토큰/이미지), PDF는 `media_resolution_medium` (560 토큰)이 권장값이다. 비용과 품질의 트레이드오프를 명시적으로 제어할 수 있게 됐다.

**Temperature 주의사항**: Gemini 3는 기본값 1.0에 최적화되어 있다. 기존 코드에서 결정론적 출력을 위해 낮은 temperature를 설정했다면 **반드시 제거**해야 한다. 낮은 temperature에서 루프나 성능 저하가 발생할 수 있다.

## LLM 토큰 & 비용 계산 도구

이미지 생성 비용을 예측할 때 텍스트 토큰뿐 아니라 이미지 출력 비용을 함께 고려해야 한다. 유용한 도구들:

- [token-calculator.net](https://token-calculator.net/) — GPT, Claude, Gemini 등 주요 LLM 토큰 수 계산 및 비용 추정. 2026년 기준 최신 모델까지 반영됨.
- [OpenAI Tokenizer](https://platform.openai.com/tokenizer) — OpenAI 공식 토크나이저. 텍스트가 실제로 어떤 토큰으로 분할되는지 시각화.

Gemini 3 Pro Image의 경우 이미지 1장 출력이 $0.134이고 해상도에 따라 추가 과금된다. 고해상도 이미지를 대량 생성하는 프로덕션 환경이라면 Batch API를 활용하면 더 높은 rate limit을 대신 최대 24시간 지연을 허용하는 방식으로 비용을 관리할 수 있다.

## 빠른 링크

- [Gemini API — Nano Banana Image Generation](https://ai.google.dev/gemini-api/docs/image-generation) — 공식 이미지 생성 가이드 (프롬프팅 전략, 코드 예제 포함)
- [Gemini 3 Developer Guide](https://ai.google.dev/gemini-api/docs/gemini-3) — Gemini 3 전체 API 가이드 (pricing, 파라미터, 마이그레이션)
- [Token Calculator](https://token-calculator.net/) — LLM 토큰 수 및 비용 계산기
- [OpenAI Tokenizer](https://platform.openai.com/tokenizer) — 토크나이저 시각화 도구

## 인사이트

Gemini 3 Pro Image의 가장 인상적인 부분은 "Thinking을 이미지 생성에 통합"한 아키텍처다. 단순히 프롬프트 → 이미지 파이프라인이 아니라, 모델이 구도를 먼저 추론하고 중간 이미지로 검증한 뒤 최종 출력을 낸다. Thought Signatures는 이 추론 컨텍스트를 API 호출 간에 보존하는 메커니즘이다. 이미지 생성 API를 프로덕션에서 쓸 때 SDK 없이 raw REST를 쓰면 signature 관리가 추가 부담이 되므로, 공식 SDK를 쓰는 게 강력히 권장된다. 해상도별 비용 구조(`image_size` 파라미터)와 Batch API 옵션을 조합하면 고품질과 비용 효율성을 동시에 잡을 수 있다.
